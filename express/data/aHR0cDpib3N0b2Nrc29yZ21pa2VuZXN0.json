{"html":"<header>\n  <aside>April 8, 2012</aside>\n  <a href=\"../\" rel=\"author\">Mike Bostock</a>\n</header>\n\n<h1>Nested Selections</h1>\n\n<p>D3’s <a href=\"https://github.com/mbostock/d3/wiki/Selections\">selections</a> can be h的顶顶的方式对该公司ierarchical, much like the elements and data they join. Consider a table:\n\n</p><pre><code class=\"html xml\"><span class=\"tag\">&lt;<span class=\"title\">table</span>&gt;</span>\n  <span class=\"tag\">&lt;<span class=\"title\">thead</span>&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"title\">tr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  A<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  B<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  C<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  D<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">tr</span>&gt;</span>\n  <span class=\"tag\">&lt;/<span class=\"title\">thead</span>&gt;</span>\n  <span class=\"tag\">&lt;<span class=\"title\">tbody</span>&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"title\">tr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  0<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  1<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  2<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  3<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">tr</span>&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"title\">tr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  4<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  5<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  6<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  7<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">tr</span>&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"title\">tr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  8<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span>  9<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span> 10<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span> 11<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">tr</span>&gt;</span>\n    <span class=\"tag\">&lt;<span class=\"title\">tr</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span> 12<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span> 13<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span> 14<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"title\">td</span>&gt;</span> 15<span class=\"tag\">&lt;/<span class=\"title\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">tr</span>&gt;</span>\n  <span class=\"tag\">&lt;/<span class=\"title\">tbody</span>&gt;</span>\n<span class=\"tag\">&lt;/<span class=\"title\">table</span>&gt;</span></code></pre>\n\n<p>How would you select only the body cells? The selector <code class=\"javascript\"><span class=\"string\">\"td\"</span></code> would match the <code class=\"javascript\">td</code> elements in the head as well as the body. To match only those elements <i>A</i> within some other elements <i>B</i>, use the <a href=\"http://www.w3.org/TR/selectors/#descendant-combinators\">descendant combinator</a>, <code class=\"javascript\"><span class=\"string\">\"B A\"</span></code>. For example:\n\n</p><aside>There are other combinators. For example, a comma results in a union: <code class=\"javascript\"><span class=\"string\">\"th, td\"</span></code> matches both <code class=\"javascript\">th</code> <i>and</i> <code class=\"javascript\">td</code> elements.</aside>\n\n<pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = d3.selectAll(<span class=\"string\">\"tbody td\"</span>);</code></pre>\n\n<p>Alternatively, select the <code class=\"javascript\">tbody</code> element first, then select the <code class=\"javascript\">td</code> elements within:\n\n</p><pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = d3.select(<span class=\"string\">\"tbody\"</span>).selectAll(<span class=\"string\">\"td\"</span>);</code></pre>\n\n<p>This produces the same result because <a href=\"https://github.com/mbostock/d3/wiki/Selections#wiki-selectAll\">selectAll</a>, for each element in the current selection, selects the matching descendants. This is convenient if you want to derive multiple selections from the same parent, such as splitting the even and odd rows of a table.\n\n</p><h2><a href=\"#index\" name=\"index\">#</a>Nesting and Index</h2>\n\n<p>If you select the <code class=\"javascript\">td</code> elements using <a href=\"https://github.com/mbostock/d3/wiki/Selections#wiki-d3_selectAll\">d3.selectAll</a>, you get a flat selection, like so:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: html\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"0\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"1\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"2\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"3\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"4\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"5\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"6\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"7\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"8\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"9\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"10\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"11\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"12\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"13\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"14\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"15\"}]}\n    ]}\n  ]},\n  360\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"360\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,180C60,180 60,180 120,180\"></path><path class=\"link\" d=\"M120,180C180,180 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,180C180,180 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M120,180C180,180 180,101.25 240,101.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,123.75 240,123.75\"></path><path class=\"link\" d=\"M120,180C180,180 180,146.25 240,146.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,168.75 240,168.75\"></path><path class=\"link\" d=\"M120,180C180,180 180,191.25 240,191.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,213.75 240,213.75\"></path><path class=\"link\" d=\"M120,180C180,180 180,236.25 240,236.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,258.75 240,258.75\"></path><path class=\"link\" d=\"M120,180C180,180 180,281.25 240,281.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,303.75 240,303.75\"></path><path class=\"link\" d=\"M120,180C180,180 180,326.25 240,326.25\"></path><path class=\"link\" d=\"M120,180C180,180 180,348.75 240,348.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><path class=\"link\" d=\"M240,101.25C300,101.25 300,101.25 360,101.25\"></path><path class=\"link\" d=\"M240,123.75C300,123.75 300,123.75 360,123.75\"></path><path class=\"link\" d=\"M240,146.25C300,146.25 300,146.25 360,146.25\"></path><path class=\"link\" d=\"M240,168.75C300,168.75 300,168.75 360,168.75\"></path><path class=\"link\" d=\"M240,191.25C300,191.25 300,191.25 360,191.25\"></path><path class=\"link\" d=\"M240,213.75C300,213.75 300,213.75 360,213.75\"></path><path class=\"link\" d=\"M240,236.25C300,236.25 300,236.25 360,236.25\"></path><path class=\"link\" d=\"M240,258.75C300,258.75 300,258.75 360,258.75\"></path><path class=\"link\" d=\"M240,281.25C300,281.25 300,281.25 360,281.25\"></path><path class=\"link\" d=\"M240,303.75C300,303.75 300,303.75 360,303.75\"></path><path class=\"link\" d=\"M240,326.25C300,326.25 300,326.25 360,326.25\"></path><path class=\"link\" d=\"M240,348.75C300,348.75 300,348.75 360,348.75\"></path><g class=\" node\" transform=\"translate(0,180)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,180)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"108\"></rect><text x=\"6\" dy=\".32em\">parentNode: html</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">0</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">1</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">2</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">3</text></g><g class=\" node\" transform=\"translate(240,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">4</text></g><g class=\" node\" transform=\"translate(240,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">5</text></g><g class=\" node\" transform=\"translate(240,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">6</text></g><g class=\" node\" transform=\"translate(240,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">7</text></g><g class=\" node\" transform=\"translate(240,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">8</text></g><g class=\" node\" transform=\"translate(240,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">9</text></g><g class=\" node\" transform=\"translate(240,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">10</text></g><g class=\" node\" transform=\"translate(240,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">11</text></g><g class=\" node\" transform=\"translate(240,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">12</text></g><g class=\" node\" transform=\"translate(240,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">13</text></g><g class=\" node\" transform=\"translate(240,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">14</text></g><g class=\" node\" transform=\"translate(240,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">15</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = d3.selectAll(<span class=\"string\">\"tbody td\"</span>);</code></pre>\n\n<p>Flat selections lack hierarchical structure: the table cells are merged into a single array, rather than grouped by parent row. This makes them more difficult to manipulate on a row- or column-basis. In contrast, D3’s nested selections retain the hierarchy. To group by row, first select the <code class=\"javascript\">tr</code> elements, then select the <code class=\"javascript\">td</code> elements:\n\n</p><aside>The concept of nested selections is one of the main differences between D3 and other DOM libraries, such as jQuery and Prototype.</aside>\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"0\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"1\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"2\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"3\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"4\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"5\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"6\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"7\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"8\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"9\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"10\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"11\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"12\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"13\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"14\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"15\"}]}\n    ]}\n  ]},\n  360\n);\n\n</script><svg width=\"1000\" height=\"360\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,180C60,180 60,45 120,45\"></path><path class=\"link\" d=\"M0,180C60,180 60,135 120,135\"></path><path class=\"link\" d=\"M0,180C60,180 60,225 120,225\"></path><path class=\"link\" d=\"M0,180C60,180 60,315 120,315\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><path class=\"link\" d=\"M120,135C180,135 180,101.25 240,101.25\"></path><path class=\"link\" d=\"M120,135C180,135 180,123.75 240,123.75\"></path><path class=\"link\" d=\"M120,135C180,135 180,146.25 240,146.25\"></path><path class=\"link\" d=\"M120,135C180,135 180,168.75 240,168.75\"></path><path class=\"link\" d=\"M240,101.25C300,101.25 300,101.25 360,101.25\"></path><path class=\"link\" d=\"M240,123.75C300,123.75 300,123.75 360,123.75\"></path><path class=\"link\" d=\"M240,146.25C300,146.25 300,146.25 360,146.25\"></path><path class=\"link\" d=\"M240,168.75C300,168.75 300,168.75 360,168.75\"></path><path class=\"link\" d=\"M120,225C180,225 180,191.25 240,191.25\"></path><path class=\"link\" d=\"M120,225C180,225 180,213.75 240,213.75\"></path><path class=\"link\" d=\"M120,225C180,225 180,236.25 240,236.25\"></path><path class=\"link\" d=\"M120,225C180,225 180,258.75 240,258.75\"></path><path class=\"link\" d=\"M240,191.25C300,191.25 300,191.25 360,191.25\"></path><path class=\"link\" d=\"M240,213.75C300,213.75 300,213.75 360,213.75\"></path><path class=\"link\" d=\"M240,236.25C300,236.25 300,236.25 360,236.25\"></path><path class=\"link\" d=\"M240,258.75C300,258.75 300,258.75 360,258.75\"></path><path class=\"link\" d=\"M120,315C180,315 180,281.25 240,281.25\"></path><path class=\"link\" d=\"M120,315C180,315 180,303.75 240,303.75\"></path><path class=\"link\" d=\"M120,315C180,315 180,326.25 240,326.25\"></path><path class=\"link\" d=\"M120,315C180,315 180,348.75 240,348.75\"></path><path class=\"link\" d=\"M240,281.25C300,281.25 300,281.25 360,281.25\"></path><path class=\"link\" d=\"M240,303.75C300,303.75 300,303.75 360,303.75\"></path><path class=\"link\" d=\"M240,326.25C300,326.25 300,326.25 360,326.25\"></path><path class=\"link\" d=\"M240,348.75C300,348.75 300,348.75 360,348.75\"></path><g class=\" node\" transform=\"translate(0,180)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">0</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">1</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">2</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">3</text></g><g class=\" node\" transform=\"translate(120,135)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">4</text></g><g class=\" node\" transform=\"translate(240,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">5</text></g><g class=\" node\" transform=\"translate(240,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">6</text></g><g class=\" node\" transform=\"translate(240,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">7</text></g><g class=\" node\" transform=\"translate(120,225)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">8</text></g><g class=\" node\" transform=\"translate(240,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">9</text></g><g class=\" node\" transform=\"translate(240,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">10</text></g><g class=\" node\" transform=\"translate(240,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">11</text></g><g class=\" node\" transform=\"translate(120,315)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">12</text></g><g class=\" node\" transform=\"translate(240,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">13</text></g><g class=\" node\" transform=\"translate(240,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">14</text></g><g class=\" node\" transform=\"translate(240,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">15</text></g></g></svg>\n\n<pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = d3.selectAll(<span class=\"string\">\"tbody tr\"</span>).selectAll(<span class=\"string\">\"td\"</span>);</code></pre>\n\n<p>Now if you want to color the first column <span style=\"color:red;\">red</span>, use the index <code class=\"javascript\">i</code>:\n\n</p><aside>This ternary expression returns null if <code class=\"javascript\">i</code> is a truthy value (non-zero), and \"red\" if is not. By returning null for the other columns, the color is inherited from the current stylesheet.</aside>\n\n<pre><code class=\"javascript\">td.style(<span class=\"string\">\"color\"</span>, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(d, i)</span> {</span> <span class=\"keyword\">return</span> i ? <span class=\"literal\">null</span> : <span class=\"string\">\"red\"</span>; });</code></pre>\n\n<p>You can also access the row index (<code class=\"javascript\">j</code>) by adding a third argument to the function.\n\n</p><h2><a href=\"#data\" name=\"data\">#</a>Nesting and Data</h2>\n\n<p>Hierarchical elements are often driven by similarly hierarchical data; nested selections are therefore convenient for binding data, too. To continue the example, you might represent the table’s associated data as a matrix (an array of arrays):\n\n</p><pre><code class=\"javascript\"><span class=\"keyword\">var</span> matrix = [\n  [ <span class=\"number\">0</span>,  <span class=\"number\">1</span>,  <span class=\"number\">2</span>,  <span class=\"number\">3</span>],\n  [ <span class=\"number\">4</span>,  <span class=\"number\">5</span>,  <span class=\"number\">6</span>,  <span class=\"number\">7</span>],\n  [ <span class=\"number\">8</span>,  <span class=\"number\">9</span>, <span class=\"number\">10</span>, <span class=\"number\">11</span>],\n  [<span class=\"number\">12</span>, <span class=\"number\">13</span>, <span class=\"number\">14</span>, <span class=\"number\">15</span>],\n];</code></pre>\n\n<p>To join the numbers to the corresponding table cells, first join the outer array (<code class=\"javascript\">matrix</code>) to the rows, and then join the inner arrays (<code class=\"javascript\">matrix[<span class=\"number\">0</span>]</code>, <code class=\"javascript\">matrix[<span class=\"number\">1</span>]</code>, …) to the cells:\n\n</p><pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = d3.selectAll(<span class=\"string\">\"tbody tr\"</span>)\n    .data(matrix)\n  .selectAll(<span class=\"string\">\"td\"</span>)\n    .data(<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(d, i)</span> {</span> <span class=\"keyword\">return</span> d; }); <span class=\"comment\">// d is matrix[i]</span></code></pre>\n\n<p>Notice that the <a href=\"https://github.com/mbostock/d3/wiki/Selections#wiki-data\">data</a> method can either take an <i>array</i> (such as <code class=\"javascript\">matrix</code>) or a <i>function</i> that returns an array. Arrays are often used with flat selections, since flat selections only have one group, while nested selections typically require a function. The initial row selection is flat, since it was created with d3.selectAll:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: html\", children: [\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]}\n    ]}\n  ]},\n  90\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"90\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,45C60,45 60,45 120,45\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><g class=\" node\" transform=\"translate(0,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"108\"></rect><text x=\"6\" dy=\".32em\">parentNode: html</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> tr = d3.selectAll(<span class=\"string\">\"tbody tr\"</span>)\n    .data(matrix);</code></pre>\n\n<p>The cell selection, in contrast, is nested:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"0\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"1\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"2\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"3\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"4\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"5\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"6\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"7\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"8\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"9\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"10\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"11\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"12\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"13\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"14\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"15\"}]}\n    ]}\n  ]},\n  360\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"360\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,180C60,180 60,45 120,45\"></path><path class=\"link\" d=\"M0,180C60,180 60,135 120,135\"></path><path class=\"link\" d=\"M0,180C60,180 60,225 120,225\"></path><path class=\"link\" d=\"M0,180C60,180 60,315 120,315\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><path class=\"link\" d=\"M120,135C180,135 180,101.25 240,101.25\"></path><path class=\"link\" d=\"M120,135C180,135 180,123.75 240,123.75\"></path><path class=\"link\" d=\"M120,135C180,135 180,146.25 240,146.25\"></path><path class=\"link\" d=\"M120,135C180,135 180,168.75 240,168.75\"></path><path class=\"link\" d=\"M240,101.25C300,101.25 300,101.25 360,101.25\"></path><path class=\"link\" d=\"M240,123.75C300,123.75 300,123.75 360,123.75\"></path><path class=\"link\" d=\"M240,146.25C300,146.25 300,146.25 360,146.25\"></path><path class=\"link\" d=\"M240,168.75C300,168.75 300,168.75 360,168.75\"></path><path class=\"link\" d=\"M120,225C180,225 180,191.25 240,191.25\"></path><path class=\"link\" d=\"M120,225C180,225 180,213.75 240,213.75\"></path><path class=\"link\" d=\"M120,225C180,225 180,236.25 240,236.25\"></path><path class=\"link\" d=\"M120,225C180,225 180,258.75 240,258.75\"></path><path class=\"link\" d=\"M240,191.25C300,191.25 300,191.25 360,191.25\"></path><path class=\"link\" d=\"M240,213.75C300,213.75 300,213.75 360,213.75\"></path><path class=\"link\" d=\"M240,236.25C300,236.25 300,236.25 360,236.25\"></path><path class=\"link\" d=\"M240,258.75C300,258.75 300,258.75 360,258.75\"></path><path class=\"link\" d=\"M120,315C180,315 180,281.25 240,281.25\"></path><path class=\"link\" d=\"M120,315C180,315 180,303.75 240,303.75\"></path><path class=\"link\" d=\"M120,315C180,315 180,326.25 240,326.25\"></path><path class=\"link\" d=\"M120,315C180,315 180,348.75 240,348.75\"></path><path class=\"link\" d=\"M240,281.25C300,281.25 300,281.25 360,281.25\"></path><path class=\"link\" d=\"M240,303.75C300,303.75 300,303.75 360,303.75\"></path><path class=\"link\" d=\"M240,326.25C300,326.25 300,326.25 360,326.25\"></path><path class=\"link\" d=\"M240,348.75C300,348.75 300,348.75 360,348.75\"></path><g class=\" node\" transform=\"translate(0,180)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">0</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">1</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">2</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">3</text></g><g class=\" node\" transform=\"translate(120,135)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">4</text></g><g class=\" node\" transform=\"translate(240,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">5</text></g><g class=\" node\" transform=\"translate(240,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">6</text></g><g class=\" node\" transform=\"translate(240,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">7</text></g><g class=\" node\" transform=\"translate(120,225)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">8</text></g><g class=\" node\" transform=\"translate(240,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">9</text></g><g class=\" node\" transform=\"translate(240,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">10</text></g><g class=\" node\" transform=\"translate(240,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">11</text></g><g class=\" node\" transform=\"translate(120,315)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">12</text></g><g class=\" node\" transform=\"translate(240,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">13</text></g><g class=\" node\" transform=\"translate(240,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">14</text></g><g class=\" node\" transform=\"translate(240,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">15</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = tr.selectAll(<span class=\"string\">\"td\"</span>)\n    .data(<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(d)</span> {</span> <span class=\"keyword\">return</span> d; }); <span class=\"comment\">// matrix[i]</span></code></pre>\n\n<p>The data operator defines the array of data for each group. Here the data function is invoked once per row and successively passed each parent datum. Since the parent data is an array of arrays, the data function simply returns the inner array for each row of cells.\n\n</p><h2><a href=\"#parent\" name=\"parent\">#</a>Nesting and the Parent Node</h2>\n\n<aside>See <a href=\"../join/\">Thinking with Joins</a> for a quick overview of D3’s data-join concept.</aside>\n\n<p>Nesting selections has another subtle yet critical side-effect: it sets the <i>parent node</i> for each group. The parent node is a hidden property on selections that determines where to append entering elements. For example, if you attempt a data-join on a top-level selection, you get an error:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: html\", children: [\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]}\n    ]}\n  ]},\n  90\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"90\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,45C60,45 60,45 120,45\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><g class=\" node\" transform=\"translate(0,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"108\"></rect><text x=\"6\" dy=\".32em\">parentNode: html</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g></g></svg><pre><code class=\"javascript\">d3.selectAll(<span class=\"string\">\"table tr\"</span>)\n    .data(matrix)\n  .enter().append(<span class=\"string\">\"tr\"</span>); <span class=\"comment\">// error!</span></code></pre>\n\n<p>The error occurs because the default parent node is the document’s root (<code class=\"javascript\">html</code>) element, and you can’t add <code class=\"javascript\">tr</code> elements directly to the root. Instead, select a parent before performing the data join:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: table\", children: [\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]}\n    ]}\n  ]},\n  90\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"90\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,45C60,45 60,45 120,45\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><g class=\" node\" transform=\"translate(0,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"114\"></rect><text x=\"6\" dy=\".32em\">parentNode: table</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g></g></svg><pre><code class=\"javascript\">d3.select(<span class=\"string\">\"table\"</span>).selectAll(<span class=\"string\">\"tr\"</span>)\n    .data(matrix)\n  .enter().append(<span class=\"string\">\"tr\"</span>); <span class=\"comment\">// success</span></code></pre>\n\n<p>This approach extends to arbitrary levels of nested selection. Say you wanted to create the table from scratch, given the matrix of numbers. Start by selecting the body:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: html\", children: [\n      {name: \"body\", children: [{type: \"text\", name: \"…\"}]}\n    ]}\n  ]},\n  30\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"30\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,15C60,15 60,15 120,15\"></path><path class=\"link\" d=\"M120,15C180,15 180,15 240,15\"></path><path class=\"link\" d=\"M240,15C300,15 300,15 360,15\"></path><g class=\" node\" transform=\"translate(0,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"108\"></rect><text x=\"6\" dy=\".32em\">parentNode: html</text></g><g class=\" node\" transform=\"translate(240,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"36\"></rect><text x=\"6\" dy=\".32em\">body</text></g><g class=\"text node\" transform=\"translate(360,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> body = d3.select(<span class=\"string\">\"body\"</span>);</code></pre>\n\n<p>Next <a href=\"https://github.com/mbostock/d3/wiki/Selections#wiki-append\">append</a> a table element to the body:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: html\", children: [\n      {name: \"table\", children: [{type: \"text\", name: \"…\"}]}\n    ]}\n  ]},\n  30\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"30\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,15C60,15 60,15 120,15\"></path><path class=\"link\" d=\"M120,15C180,15 180,15 240,15\"></path><path class=\"link\" d=\"M240,15C300,15 300,15 360,15\"></path><g class=\" node\" transform=\"translate(0,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"108\"></rect><text x=\"6\" dy=\".32em\">parentNode: html</text></g><g class=\" node\" transform=\"translate(240,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"42\"></rect><text x=\"6\" dy=\".32em\">table</text></g><g class=\"text node\" transform=\"translate(360,15)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> table = body.append(<span class=\"string\">\"table\"</span>);</code></pre>\n\n<p>Now append entering rows to the table via data-join. Since selectAll is called on the selected table element, it establishes a new parent node:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: table\", children: [\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]},\n      {name: \"tr\", children: [{type: \"text\", name: \"…\"}]}\n    ]}\n  ]},\n  90\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"90\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,45C60,45 60,45 120,45\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><g class=\" node\" transform=\"translate(0,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"114\"></rect><text x=\"6\" dy=\".32em\">parentNode: table</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">tr</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">…</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> tr = table.selectAll(<span class=\"string\">\"tr\"</span>)\n    .data(matrix)\n  .enter().append(<span class=\"string\">\"tr\"</span>);</code></pre>\n\n<p>Finally, append entering cells to each row:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"0\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"1\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"2\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"3\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"4\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"5\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"6\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"7\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"8\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"9\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"10\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"11\"}]}\n    ]},\n    {name: \"parentNode: tr\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"12\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"13\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"14\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"15\"}]}\n    ]}\n  ]},\n  360\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"360\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,180C60,180 60,45 120,45\"></path><path class=\"link\" d=\"M0,180C60,180 60,135 120,135\"></path><path class=\"link\" d=\"M0,180C60,180 60,225 120,225\"></path><path class=\"link\" d=\"M0,180C60,180 60,315 120,315\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><path class=\"link\" d=\"M120,135C180,135 180,101.25 240,101.25\"></path><path class=\"link\" d=\"M120,135C180,135 180,123.75 240,123.75\"></path><path class=\"link\" d=\"M120,135C180,135 180,146.25 240,146.25\"></path><path class=\"link\" d=\"M120,135C180,135 180,168.75 240,168.75\"></path><path class=\"link\" d=\"M240,101.25C300,101.25 300,101.25 360,101.25\"></path><path class=\"link\" d=\"M240,123.75C300,123.75 300,123.75 360,123.75\"></path><path class=\"link\" d=\"M240,146.25C300,146.25 300,146.25 360,146.25\"></path><path class=\"link\" d=\"M240,168.75C300,168.75 300,168.75 360,168.75\"></path><path class=\"link\" d=\"M120,225C180,225 180,191.25 240,191.25\"></path><path class=\"link\" d=\"M120,225C180,225 180,213.75 240,213.75\"></path><path class=\"link\" d=\"M120,225C180,225 180,236.25 240,236.25\"></path><path class=\"link\" d=\"M120,225C180,225 180,258.75 240,258.75\"></path><path class=\"link\" d=\"M240,191.25C300,191.25 300,191.25 360,191.25\"></path><path class=\"link\" d=\"M240,213.75C300,213.75 300,213.75 360,213.75\"></path><path class=\"link\" d=\"M240,236.25C300,236.25 300,236.25 360,236.25\"></path><path class=\"link\" d=\"M240,258.75C300,258.75 300,258.75 360,258.75\"></path><path class=\"link\" d=\"M120,315C180,315 180,281.25 240,281.25\"></path><path class=\"link\" d=\"M120,315C180,315 180,303.75 240,303.75\"></path><path class=\"link\" d=\"M120,315C180,315 180,326.25 240,326.25\"></path><path class=\"link\" d=\"M120,315C180,315 180,348.75 240,348.75\"></path><path class=\"link\" d=\"M240,281.25C300,281.25 300,281.25 360,281.25\"></path><path class=\"link\" d=\"M240,303.75C300,303.75 300,303.75 360,303.75\"></path><path class=\"link\" d=\"M240,326.25C300,326.25 300,326.25 360,326.25\"></path><path class=\"link\" d=\"M240,348.75C300,348.75 300,348.75 360,348.75\"></path><g class=\" node\" transform=\"translate(0,180)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">0</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">1</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">2</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">3</text></g><g class=\" node\" transform=\"translate(120,135)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,101.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">4</text></g><g class=\" node\" transform=\"translate(240,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,123.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">5</text></g><g class=\" node\" transform=\"translate(240,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,146.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">6</text></g><g class=\" node\" transform=\"translate(240,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,168.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">7</text></g><g class=\" node\" transform=\"translate(120,225)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,191.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">8</text></g><g class=\" node\" transform=\"translate(240,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,213.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">9</text></g><g class=\" node\" transform=\"translate(240,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,236.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">10</text></g><g class=\" node\" transform=\"translate(240,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,258.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">11</text></g><g class=\" node\" transform=\"translate(120,315)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"96\"></rect><text x=\"6\" dy=\".32em\">parentNode: tr</text></g><g class=\" node\" transform=\"translate(240,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,281.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">12</text></g><g class=\" node\" transform=\"translate(240,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,303.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">13</text></g><g class=\" node\" transform=\"translate(240,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,326.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">14</text></g><g class=\" node\" transform=\"translate(240,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,348.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">15</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = tr.selectAll(<span class=\"string\">\"td\"</span>)\n    .data(<span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(d)</span> {</span> <span class=\"keyword\">return</span> d; })\n  .enter().append(<span class=\"string\">\"td\"</span>);</code></pre>\n\n<h2><a href=\"#conclusion\" name=\"conclusion\">#</a>To Nest, or not to Nest</h2>\n\n<p>There is an important difference between <a href=\"https://github.com/mbostock/d3/wiki/Selections#wiki-select\">select</a> and <a href=\"https://github.com/mbostock/d3/wiki/Selections#wiki-selectAll\">selectAll</a>: select <i>preserves</i> the existing grouping, whereas selectAll <i>creates</i> a new grouping. Calling select thus preserves the data, index and even the parent node of the original selection! For example, the following selection is flat, with the parent node still the document root:\n\n<script>\n\ntree(\n  {name: \"selection\", children: [\n    {name: \"parentNode: html\", children: [\n      {name: \"td\", children: [{type: \"text\", name: \"0\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"4\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"8\"}]},\n      {name: \"td\", children: [{type: \"text\", name: \"12\"}]}\n    ]}\n  ]},\n  90\n);\n\n</script>\n\n</p><svg width=\"1000\" height=\"90\" style=\"margin: 1em 0px 1em -40px;\"><g transform=\"translate(40,0)\"><path class=\"link\" d=\"M0,45C60,45 60,45 120,45\"></path><path class=\"link\" d=\"M120,45C180,45 180,11.25 240,11.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,33.75 240,33.75\"></path><path class=\"link\" d=\"M120,45C180,45 180,56.25 240,56.25\"></path><path class=\"link\" d=\"M120,45C180,45 180,78.75 240,78.75\"></path><path class=\"link\" d=\"M240,11.25C300,11.25 300,11.25 360,11.25\"></path><path class=\"link\" d=\"M240,33.75C300,33.75 300,33.75 360,33.75\"></path><path class=\"link\" d=\"M240,56.25C300,56.25 300,56.25 360,56.25\"></path><path class=\"link\" d=\"M240,78.75C300,78.75 300,78.75 360,78.75\"></path><g class=\" node\" transform=\"translate(0,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"66\"></rect><text x=\"6\" dy=\".32em\">selection</text></g><g class=\" node\" transform=\"translate(120,45)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"108\"></rect><text x=\"6\" dy=\".32em\">parentNode: html</text></g><g class=\" node\" transform=\"translate(240,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,11.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">0</text></g><g class=\" node\" transform=\"translate(240,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,33.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">4</text></g><g class=\" node\" transform=\"translate(240,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,56.25)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">8</text></g><g class=\" node\" transform=\"translate(240,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">td</text></g><g class=\"text node\" transform=\"translate(360,78.75)\"><rect ry=\"6\" rx=\"6\" y=\"-10\" height=\"20\" width=\"32\"></rect><text x=\"6\" dy=\".32em\">12</text></g></g></svg><pre><code class=\"javascript\"><span class=\"keyword\">var</span> td = d3.selectAll(<span class=\"string\">\"tbody tr\"</span>).select(<span class=\"string\">\"td\"</span>);</code></pre>\n\n<p>The only way to obtain a nested selection, then, is to call selectAll on an existing selection; this is why a data-join typically follows a selectAll rather than select.\n\n</p><p>This tutorial employed tables as an example of hierarchical structure. This is but one contrived example—nested selections are <a href=\"http://bost.ocks.org/mike/miserables/\">surprisingly</a> <a href=\"http://bl.ocks.org/882152\">common</a>! By making only a few code changes, nested selections can quickly turn any singular visualization into <a href=\"http://bl.ocks.org/1305111\">small multiples</a>. Much like <a href=\"../join/\">thinking with joins</a>, nested selections require a different mental model for creating and manipulating elements. But once mastered, they provide a concise way of creating <a href=\"http://d3js.org/\">data-driven documents</a>.\n\n</p><footer>\n  <aside>April 8, 2012</aside>\n  <a href=\"../\" rel=\"author\">Mike Bostock</a>\n</footer>\n\n<script>\n\nGoogleAnalyticsObject = \"ga\", ga = function() { ga.q.push(arguments); }, ga.q = [], ga.l = +new Date;\nga(\"create\", \"UA-48272912-3\", \"ocks.org\");\nga(\"send\", \"pageview\");\n\n</script>\n<script async=\"\" src=\"../highlight.min.js\"></script>\n<script async=\"\" src=\"//www.google-analytics.com/analytics.js\"></script>\n<div class=\"cm-popover\" id=\"cm-popover\" style=\"display: none;\">                <div class=\"cm-popover__arrow\">                    <span class=\"cm-popover__arrow-bg\"></span>                </div>                <div class=\"cm-popover__raw-open\">null</div>            </div><style>.tb_button {padding:1px;cursor:pointer;border-right: 1px solid #8b8b8b;border-left: 1px solid #FFF;border-bottom: 1px solid #fff;}.tb_button.hover {borer:2px outset #def; background-color: #f8f8f8 !important;}.ws_toolbar {z-index:100000} .ws_toolbar .ws_tb_btn {cursor:pointer;border:1px solid #555;padding:3px}   .tb_highlight{background-color:yellow} .tb_hide {visibility:hidden} .ws_toolbar img {padding:2px;margin:0px}</style>"}